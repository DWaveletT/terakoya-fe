import{ai as w,bS as B,Y as _,V as I,_ as k,G as T,H as N,$ as S,a0 as C,a1 as a,aa as z,a3 as P,a4 as l,ah as U,af as $,ag as F,an as R,O as f,aB as A,b6 as D,b7 as O,bh as q,bT as G,b8 as H,P as K,a2 as b,aS as e,bo as L,ba as M,bb as g,bc as Y,ac as c,ad as j,b9 as J,be as Q,bf as x,b5 as W}from"./index-BRCLu9w8.js";import{B as X}from"./BlockSidebar-CMCsi5by.js";import{T as Z}from"./TextEditor-D7bp0jgb.js";import{u as ee}from"./config-DgyNTR-V.js";import{E as h,a as te}from"./index-BZ0pmUbF.js";import"./index-BKkidD8n.js";const ae=w({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:B,default:""},truncated:{type:Boolean},lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),le=_({name:"ElText"}),se=_({...le,props:ae,setup(y){const i=y,d=I(),n=k("text"),p=T(()=>[n.b(),n.m(i.type),n.m(d.value),n.is("truncated",i.truncated),n.is("line-clamp",!N(i.lineClamp))]);return(u,v)=>(S(),C($(u.tag),{class:P(l(p)),style:U({"-webkit-line-clamp":u.lineClamp})},{default:a(()=>[z(u.$slots,"default")]),_:3},8,["class","style"]))}});var oe=F(se,[["__file","text.vue"]]);const ne=R(oe),re={class:"main-container"},ue={class:"submit"},ie=_({__name:"PostNew",setup(y){const i=ee(),d=f([]);A(()=>{i.getBoards().then(t=>d.value=t)});const n=G(),p=H(),u=D();O();function v(){let t=n.query.boardId;return K(t)?parseInt(t[0]||"1"):parseInt(t||"1")}const m=f(v()),r=f({id:null,board:null,like:null,dislike:null,title:"",content:"",poster:null,time:null});async function V(){Q({url:"http://43.143.171.43:9999/api/post/create",method:"POST",data:{board:m.value,title:r.value.title,content:r.value.content,token:u.getToken()},withCredentials:!0}).then(t=>{p.push("/post/"+t.data.pid)}).catch(t=>{let s=t.response;!s||!s.data?x({title:"未知错误",message:"",type:"error"}):(x({title:"创建失败",message:s.data.message,type:"error"}),t.status===401&&(u.logout(),p.push({name:"login"})))})}return(t,s)=>(S(),C(q,{bread:[{label:"寺子屋",name:"home"},{label:"帖子列表",name:"post.list"},{label:"发布帖子"}],title:"发布帖子"},{default:a(()=>[b("div",re,[e(l(te),{gutter:20},{default:a(()=>[e(l(h),{span:6},{default:a(()=>[e(X,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=o=>m.value=o)},null,8,["modelValue"])]),_:1}),e(l(h),{span:18},{default:a(()=>[e(l(L),null,{default:a(()=>[e(l(M),{model:r.value,"label-width":"auto"},{default:a(()=>[e(l(g),{label:"帖子标题"},{default:a(()=>[e(l(Y),{type:"text",modelValue:r.value.title,"onUpdate:modelValue":s[1]||(s[1]=o=>r.value.title=o),placeholder:"长度应介于 1 至 10 之间"},null,8,["modelValue"])]),_:1}),e(l(g),{label:"帖子内容"},{default:a(()=>[e(Z,{modelValue:r.value.content,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value.content=o),style:{"flex-grow":"1"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("div",ue,[b("span",null,[c("将会发布在 "),e(l(ne),{type:"primary",size:"large"},{default:a(()=>{var o;return[c(j((o=d.value.find(E=>E.id===m.value))==null?void 0:o.name),1)]}),_:1}),c(" 版块")]),e(l(J),{type:"primary",onClick:V},{default:a(()=>[c("发布")]),_:1})])]),_:1})]),_:1})]),_:1})])]),_:1}))}}),_e=W(ie,[["__scopeId","data-v-e728e397"]]);export{_e as default};
