import{ai as w,bS as B,Y as _,V as I,_ as k,G as T,H as N,$ as h,a0 as C,a1 as t,aa as z,a3 as P,a4 as a,ah as U,af as $,ag as F,an as R,O as f,aB as A,b8 as D,bg as O,bT as q,bQ as G,P as H,a2 as b,aS as e,bn as K,bc as L,bd as g,be as M,ac as m,ad as Q,b7 as Y,ba as j,bb as x,b5 as J}from"./index-C79AFz9e.js";import{u as W,B as X}from"./BlockSidebar-Cg-daOVO.js";import{T as Z}from"./TextEditor-DS6esd9t.js";import{E as S,a as ee}from"./index-CnESm0Bb.js";import"./index-BV-SJpnz.js";const te=w({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:B,default:""},truncated:{type:Boolean},lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),ae=_({name:"ElText"}),le=_({...ae,props:te,setup(y){const u=y,d=I(),n=k("text"),c=T(()=>[n.b(),n.m(u.type),n.m(d.value),n.is("truncated",u.truncated),n.is("line-clamp",!N(u.lineClamp))]);return(i,v)=>(h(),C($(i.tag),{class:P(a(c)),style:U({"-webkit-line-clamp":i.lineClamp})},{default:t(()=>[z(i.$slots,"default")]),_:3},8,["class","style"]))}});var se=F(le,[["__file","text.vue"]]);const oe=R(se),ne={class:"main-container"},re={class:"submit"},ue=_({__name:"PostNew",setup(y){const u=W(),d=f([]);A(()=>{u.getBoards().then(l=>d.value=l)});const n=q(),c=G(),i=D();function v(){let l=n.query.boardId;return H(l)?parseInt(l[0]||"1"):parseInt(l||"1")}const p=f(v()),r=f({id:null,board:null,like:null,dislike:null,title:"",content:"",poster:null,time:null});async function V(){j({url:"http://43.143.171.43:9999/api/post/create",method:"POST",data:{board:p.value,title:r.value.title,content:r.value.content,token:i.getToken()},withCredentials:!0}).then(l=>{c.push("/post/"+l.data.pid)}).catch(l=>{let s=l.response;!s||!s.data?x({title:"未知错误",message:"",type:"error"}):x({title:"创建失败",message:s.data.message,type:"error"})})}return(l,s)=>(h(),C(O,{bread:[{label:"寺子屋",name:"home"},{label:"帖子列表",name:"post.list"},{label:"发布帖子"}],title:"发布帖子"},{default:t(()=>[b("div",ne,[e(a(ee),{gutter:20},{default:t(()=>[e(a(S),{span:6},{default:t(()=>[e(X,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=o=>p.value=o)},null,8,["modelValue"])]),_:1}),e(a(S),{span:18},{default:t(()=>[e(a(K),null,{default:t(()=>[e(a(L),{model:r.value,"label-width":"auto"},{default:t(()=>[e(a(g),{label:"帖子标题"},{default:t(()=>[e(a(M),{type:"text",modelValue:r.value.title,"onUpdate:modelValue":s[1]||(s[1]=o=>r.value.title=o),placeholder:"长度应介于 1 至 10 之间"},null,8,["modelValue"])]),_:1}),e(a(g),{label:"帖子内容"},{default:t(()=>[e(Z,{modelValue:r.value.content,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value.content=o),style:{"flex-grow":"1"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("div",re,[b("span",null,[m("将会发布在 "),e(a(oe),{type:"primary",size:"large"},{default:t(()=>{var o;return[m(Q((o=d.value.find(E=>E.id===p.value))==null?void 0:o.name),1)]}),_:1}),m(" 版块")]),e(a(Y),{type:"primary",onClick:V},{default:t(()=>[m("发布")]),_:1})])]),_:1})]),_:1})]),_:1})])]),_:1}))}}),fe=J(ue,[["__scopeId","data-v-e914f0cd"]]);export{fe as default};
