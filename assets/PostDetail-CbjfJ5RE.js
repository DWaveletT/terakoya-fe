import{_ as x,a1 as v,a8 as $,a4 as e,as as t,bd as H,ac as V,aj as J,aX as T,a2 as D,a3 as r,a6 as o,b8 as Q,ba as z,bb as M,bl as K,bg as W,Q as P,bo as ee,bc as te,P as h,G as oe,aG as se,aZ as le,bp as ae,ad as L,bq as ne,br as re,ae as u,ag as ie,aE as ue,b2 as f,af as m,aY as y,a$ as de,bs as ce}from"./index-BmzEAcIX.js";import{C as R,_ as E,a as S,b as U,c as pe,d as fe,e as ve}from"./index-Hkd_HnvZ.js";import{_ as q,T as _e}from"./TextEditor-B8gkInz3.js";import{u as me}from"./test-HpMqCO6I.js";import{E as A}from"./index-CDx8ZcPp.js";const ge={class:"content"},ye={class:"header"},ke={class:"avatar"},be={class:"message"},he=x({__name:"CBubble",props:{user:{},borderColor:{default:"var(--el-color-primary)"}},setup(i){const c=i;return(p,g)=>(v(),$("div",ge,[e("div",{class:"bubble",style:J({"--border-color":c.borderColor})},[e("div",ye,[e("div",ke,[t(H,{user:c.user},null,8,["user"])]),V(p.$slots,"header",{},void 0,!0)]),e("div",be,[V(p.$slots,"message",{},void 0,!0)])],4)]))}}),N=T(he,[["__scopeId","data-v-52fab470"]]),j=i=>(z("data-v-e772472f"),i=i(),M(),i),Ce=j(()=>e("div",{class:"bar-top"},null,-1)),Ie=j(()=>e("div",{class:"bar-bottom"},null,-1)),Pe=x({__name:"CInfoCard",setup(i){return(c,p)=>(v(),D(o(Q),{shadow:"never",class:"card"},{default:r(()=>[Ce,V(c.$slots,"default",{},void 0,!0),Ie]),_:3}))}}),$e=T(Pe,[["__scopeId","data-v-e772472f"]]),De=K("util",()=>{const i=W(),c={id:0,name:"未知用户",role:1},p={id:0,time:0,poster:c,board:0,title:"未知帖子",content:"",like:0,dislike:0},g={id:0,name:"未知版块",description:""},C={id:0,time:0,replyer:c,post:0,content:"",like:0,dislike:0},k={id:0,time:0,poster:c,board:0,title:"不存在的帖子",content:"请检查帖子 ID 是否正确",like:0,dislike:0};function b(d){const s=i.params[d];if(s!==null)return P(s)?s[0]?s[0]:void 0:s}function w(d){const s=i.params[d];if(s!==null)return P(s)?s[0]?parseInt(s[0]):void 0:parseInt(s)}function I(d){const s=i.query[d];if(s!==null)return P(s)?s[0]?s[0]:void 0:s}function a(d){const s=i.query[d];if(s!==null)return P(s)?s[0]?parseInt(s[0]):void 0:parseInt(s)}return{fakeUser:c,fakePost:p,fakeBoard:g,fakeReply:C,nonePost:k,parseParamInt:w,parseParamString:b,parseQueryInt:a,parseQueryString:I}}),B=i=>(z("data-v-afbadb2a"),i=i(),M(),i),we=B(()=>e("div",{class:"reply-operator"}," 楼主 ",-1)),Ee={class:"reply-operator"},Se=["onClick"],Ue=["onClick"],Ve=B(()=>e("h3",{style:{margin:"0"}},"回复帖子",-1)),xe=B(()=>e("span",{class:"please-login"},"请先登录",-1)),Te=[xe],Be={class:"reply-buttons"},Le={class:"aside"},Re={style:{margin:"0.5em","text-align":"center"}},qe={class:"info"},Ae={class:"info-item"},Ne={class:"info-item"},Qe={class:"info-item"},ze={class:"info-item"},Me={class:"info-item"},je={class:"post-operator"},Fe=x({__name:"PostDetail",setup(i){const c=ee();te();const p=De(),g=h(!1),C=h(null),k=h(""),b=oe("scrollbar-wrap");function w(){b==null||b.scrollTo({top:C.value.offsetTop-10,behavior:"smooth"})}const I=me(),a=h({post:p.fakePost,replys:[],total:100}),d=h(p.parseQueryInt("page")||1);function s(){console.log("query post detail");let _=p.parseParamInt("pid");if(_===void 0){a.value={post:p.nonePost,replys:[],total:0};return}let n=I.testPost.find(l=>l.id===_);if(console.log(n),n===void 0){a.value={post:p.nonePost,replys:[],total:0};return}a.value={post:n,replys:I.testReply.filter(l=>l.post===n.id),total:100}}function F(){console.log("do post delete")}function G(){console.log("do post like")}function O(){console.log("do post dislike")}function X(_){console.log("do reply like",_)}function Y(_){console.log("do reply dislike",_)}return se(()=>{s()}),(_,n)=>(v(),$(L,null,[t(le,{title:a.value.post.title,bread:["首页","讨论详情"]},{default:r(()=>[t(o(ne),{class:"main-container"},{default:r(()=>[t(o(re),{class:"main"},{default:r(()=>[t(N,{user:a.value.post.poster,"border-color":"var(--el-color-warning)"},{header:r(()=>[t(R,{user:a.value.post.poster},null,8,["user"]),u(" / "),t(E,{date:new Date(a.value.post.time)},null,8,["date"]),we]),message:r(()=>[t(q,{content:a.value.post.content},null,8,["content"])]),_:1},8,["user"]),a.value.replys.length>5?(v(),D(o(A),{key:0,"page-size":20,"pager-count":7,layout:"prev, pager, next",total:a.value.total,background:"","hide-on-single-page":"",small:"",class:"pagination","current-page":d.value,"onUpdate:currentPage":n[0]||(n[0]=l=>d.value=l)},null,8,["total","current-page"])):ie("",!0),(v(!0),$(L,null,ue(a.value.replys,l=>(v(),D(N,{key:l.id,user:l.replyer},{header:r(()=>[t(R,{user:l.replyer},null,8,["user"]),u(" / "),t(E,{date:new Date(l.time)},null,8,["date"]),e("div",Ee,[e("span",{onClick:Z=>X(l.id)},[t(o(f),{icon:o(S)},null,8,["icon"]),u(" "+m(l.like),1)],8,Se),e("span",{onClick:Z=>Y(l.id)},[t(o(f),{icon:o(U)},null,8,["icon"]),u(" "+m(l.dislike),1)],8,Ue)])]),message:r(()=>[t(q,{content:l.content},null,8,["content"])]),_:2},1032,["user"]))),128)),t(o(A),{hideOnSinglePage:"","page-size":20,"pager-count":7,layout:"prev, pager, next",total:a.value.total,background:"",small:"",class:"pagination","current-page":d.value,"onUpdate:currentPage":n[1]||(n[1]=l=>d.value=l)},null,8,["total","current-page"]),e("div",{ref_key:"reply",ref:C},null,512),t(o(Q),{shadow:"hover"},{default:r(()=>[Ve,o(c).isLoggedIn?(v(),D(_e,{key:0,modelValue:k.value,"onUpdate:modelValue":n[2]||(n[2]=l=>k.value=l),placeholder:"请在此处回复，支持使用 Markdown。"},null,8,["modelValue"])):(v(),$("div",{key:1,class:"login-area",onClick:n[3]||(n[3]=l=>g.value=!0)},Te)),e("div",Be,[t(o(y),{type:"danger",plain:"",onClick:n[4]||(n[4]=l=>k.value="")},{default:r(()=>[u("清除")]),_:1}),t(o(y),{type:"primary"},{default:r(()=>[u("回复")]),_:1})])]),_:1})]),_:1}),e("aside",Le,[t(o(de),{offset:30},{default:r(()=>[t($e,null,{default:r(()=>[e("h3",Re,m(a.value.post.title),1),t(o(ce)),e("div",qe,[e("div",Ae,[e("div",null,[t(o(f),{icon:o(pe)},null,8,["icon"]),u(" 楼主")]),e("div",null,m(a.value.post.poster.name),1)]),e("div",Ne,[e("div",null,[t(o(f),{icon:o(fe)},null,8,["icon"]),u(" 发布时间")]),t(E,{date:new Date(a.value.post.time),type:"detail"},null,8,["date"])]),e("div",Qe,[e("div",null,[t(o(f),{icon:o(ve)},null,8,["icon"]),u(" 回复个数")]),e("div",null,m(a.value.total),1)]),e("div",ze,[e("div",null,[t(o(f),{icon:o(S)},null,8,["icon"]),u(" 点赞量")]),e("div",null,m(a.value.post.like),1)]),e("div",Me,[e("div",null,[t(o(f),{icon:o(U)},null,8,["icon"]),u(" 点踩量")]),e("div",null,m(a.value.post.dislike),1)])])]),_:1}),e("div",je,[e("div",null,[t(o(y),{type:"success",plain:"",circle:"",onClick:G},{default:r(()=>[t(o(f),{icon:o(S)},null,8,["icon"])]),_:1}),t(o(y),{type:"danger",plain:"",circle:"",onClick:O},{default:r(()=>[t(o(f),{icon:o(U)},null,8,["icon"])]),_:1})]),e("div",null,[t(o(y),{type:"primary",plain:"",onClick:w},{default:r(()=>[u("回复")]),_:1}),t(o(y),{type:"danger",plain:"",onClick:F},{default:r(()=>[u("删除")]),_:1})])])]),_:1})])]),_:1})]),_:1},8,["title"]),t(ae,{modelValue:g.value,"onUpdate:modelValue":n[5]||(n[5]=l=>g.value=l)},null,8,["modelValue"])],64))}}),He=T(Fe,[["__scopeId","data-v-afbadb2a"]]);export{He as default};
